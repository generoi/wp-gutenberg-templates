!function(e){var t={};function i(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=t,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:a})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/",i(i.s=0)}([function(e,t,i){e.exports=i(1)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(2),n=(i.n(a),i(3)),o=(i.n(n),i(4)),s=i.n(o),l=i(5),c=(i.n(l),function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}());new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.previousTemplateName=null,this.templateName=void 0,this.settings=null,Object(a.subscribe)(this.subscribe.bind(this))}return c(e,[{key:"subscribe",value:function(){var e=Object(a.dispatch)("core/block-editor"),t=e.updateSettings,i=e.setTemplateValidity,n=Object(a.select)("core/editor").getEditedPostAttribute("template"),o=Object(a.select)("core/block-editor").getTemplate(),s=Object(a.select)("core/block-editor").getTemplateLock();if(void 0!==n){if(void 0===this.templateName)return this.templateName=n,this.defaultTemplate=o,this.defaultTemplateLock=s,void(this.templateName&&this.setInitialTemplate(this.templateName));if(n!==this.templateName){if(this.previousTemplateName=this.templateName,this.templateName=n,n)return void this.changeTemplate(this.templateName);""===n&&(this.settings={templateLock:this.defaultTemplateLock,template:this.defaultTemplate},t(this.settings),i(!0))}!this.settings||this.settings.template===o&&this.settings.templateLock===s||(console.log(this.settings),t(this.settings))}}},{key:"getTemplate",value:function(e,t){var i=this;s()({path:"/gutenberg-templates/v1/template",data:{template:e}}).then(function(e){var a=e.template,n=e.template_lock;i.settings={template:a,templateLock:n},t(i.settings)})}},{key:"setInitialTemplate",value:function(e){this.getTemplate(e,function(e){var t=e.template,i=e.templateLock,n=Object(a.dispatch)("core/block-editor"),o=n.updateSettings,s=n.setTemplateValidity,c=Object(a.select)("core/block-editor").getBlocks(),r=!t||"all"!==i||Object(l.doBlocksMatchTemplate)(c,t);o({templateLock:i,template:t}),s(r)})}},{key:"changeTemplate",value:function(e){var t=this;this.getTemplate(e,function(e){var i=e.template,o=e.templateLock,s=Object(a.dispatch)("core/block-editor"),c=s.resetBlocks,r=s.updateSettings,p=Object(a.dispatch)("core/notices"),u=p.createWarningNotice,m=p.removeNotice,h=Object(a.select)("core/block-editor").getBlocks(),b=function(){c(Object(l.synchronizeBlocksWithTemplate)(h,i)),r({template:i,templateLock:o})};!i||Object(l.doBlocksMatchTemplate)(h,i)?b():u(Object(n.__)("The content of your post doesn't match the assigned template.","wp-gutenberg-templates"),{actions:[{label:Object(n.__)("Keep it as is","wp-gutenberg-templates"),onClick:function(){"all"===o&&t.revertTemplate(),m("SYNCHRONIZE_TEMPLATE_NOTICE_ID")}},{label:Object(n.__)("Reset the template","wp-gutenberg-templates"),onClick:function(){window.confirm(Object(n.__)("Resetting the template may result in loss of content, do you want to continue?","wp-gutenberg-templates"))&&b(),m("SYNCHRONIZE_TEMPLATE_NOTICE_ID")},className:"is-primary"}],isDismissible:!0,id:"SYNCHRONIZE_TEMPLATE_NOTICE_ID"})})}},{key:"revertTemplate",value:function(){Object(a.dispatch)("core/editor").editPost({template:this.previousTemplateName})}}]),e}())},function(e,t){e.exports=wp.data},function(e,t){e.exports=wp.i18n},function(e,t){e.exports=wp.apiRequest},function(e,t){e.exports=wp.blocks}]);