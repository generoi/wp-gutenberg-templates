!function(e){var t={};function o(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/",o(o.s=0)}([function(e,t,o){e.exports=o(1)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(2),a=(o.n(n),o(3)),i=(o.n(a),o(4)),l=o.n(i),c=o(5),r=(o.n(c),function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}());new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.previousTemplate=null,this.template=void 0,Object(n.subscribe)(this.subscribe.bind(this))}return r(e,[{key:"subscribe",value:function(){var e=Object(n.select)("core/editor").getEditedPostAttribute("template");if(void 0!==e){if(void 0===this.template)return console.log("initial template"),this.template=e,void(this.template&&this.setInitialTemplate(this.template));if(e!==this.template){if(console.log("template has changed"),this.previousTemplate=this.template,this.template=e,e)return void this.changeTemplate(this.template);if(""===e){console.log("setting default template");var t=Object(n.dispatch)("core/block-editor"),o=t.updateSettings,a=t.setTemplateValidity;o({templateLock:!1}),a(!0)}}}else console.log("template not known")}},{key:"setInitialTemplate",value:function(e){var t=Object(n.dispatch)("core/block-editor"),o=t.updateSettings,a=t.setTemplateValidity;l()({path:"/gutenberg-templates/v1/template",data:{template:e}}).then(function(e){var t=Object(n.select)("core/block-editor").getBlocks(),i=e.template,l=e.template_lock,r=!i||"all"!==l||Object(c.doBlocksMatchTemplate)(t,i);o({templateLock:l,template:i}),a(r)})}},{key:"changeTemplate",value:function(e){var t=this;console.log("change template");var o=Object(n.dispatch)("core/block-editor"),i=o.resetBlocks,r=o.updateSettings,s=Object(n.dispatch)("core/notices"),p=s.createWarningNotice,u=s.removeNotice;l()({path:"/gutenberg-templates/v1/template",data:{template:e}}).then(function(e){var o=Object(n.select)("core/block-editor").getBlocks(),l=e.template,s=e.template_lock,m=function(){console.log(o,l),i(Object(c.synchronizeBlocksWithTemplate)(o,l)),r({template:l,templateLock:s})};(!l||Object(c.doBlocksMatchTemplate)(o,l))&&m(),p(Object(a.__)("The content of your post doesn't match the assigned template.","wp-gutenberg-templates"),{actions:[{label:Object(a.__)("Keep it as is","wp-gutenberg-templates"),onClick:function(){console.log("revert"),"all"===s&&t.revertTemplate(),u("SYNCHRONIZE_TEMPLATE_NOTICE_ID")}},{label:Object(a.__)("Reset the template","wp-gutenberg-templates"),onClick:function(){window.confirm(Object(a.__)("Resetting the template may result in loss of content, do you want to continue?","wp-gutenberg-templates"))&&m(),u("SYNCHRONIZE_TEMPLATE_NOTICE_ID")},className:"is-primary"}],isDismissible:!0,id:"SYNCHRONIZE_TEMPLATE_NOTICE_ID"})})}},{key:"revertTemplate",value:function(){Object(n.dispatch)("core/editor").editPost({template:this.previousTemplate})}}]),e}())},function(e,t){e.exports=wp.data},function(e,t){e.exports=wp.i18n},function(e,t){e.exports=wp.apiRequest},function(e,t){e.exports=wp.blocks}]);